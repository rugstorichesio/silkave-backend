// Leaderboard functionality for Silk Ave

document.addEventListener("DOMContentLoaded", () => {
  fetchScores()
})

// Fetch scores from the backend
function fetchScores() {
  // Show loading state
  const scoreList = document.getElementById("scoreList")
  scoreList.innerHTML = "<li>Loading scores...</li>"

  // Try to fetch from the backend
  fetch("https://silkave-backend.onrender.com/scores")
    .then((response) => {
      if (!response.ok) {
        throw new Error("Network response was not ok")
      }
      return response.json()
    })
    .then((data) => {
      // Clear loading message
      scoreList.innerHTML = ""

      // Check if we have scores
      if (data.length === 0) {
        scoreList.innerHTML = "<li>No scores yet. Be the first.</li>"
        return
      }

      // Sort scores by BTC (highest first)
      data.sort((a, b) => b.btc - a.btc)

      // Display scores
      data.forEach((entry, index) => {
        const item = document.createElement("li")
        item.innerHTML = `<strong>${index + 1}.</strong> ${entry.alias} – ${entry.btc} BTC – Glock: ${entry.glock}`

        // Highlight top 3
        if (index < 3) {
          item.style.color = "#0f0"
          item.style.fontWeight = "bold"
        }

        scoreList.appendChild(item)
      })
    })
    .catch((error) => {
      console.error("Error fetching scores:", error)
      scoreList.innerHTML = "<li>Failed to load scores. Please try again later.</li>"
    })
}
